<div class="container">
  <h2 class="title">Detalles de la Lista</h2>
  <p class="list-name">
    <strong>Lista:</strong> 
    <span *ngIf="!editandoNombre">{{ listaNombre }}</span>
    <input *ngIf="editandoNombre" [(ngModel)]="nuevoNombreLista" />
  </p>

  <!-- Botón de editar nombre solo visible para el creador -->
  <button *ngIf="esCreador && !editandoNombre" (click)="editarNombreLista()" class="btn edit-name-btn">Editar Nombre</button>

  <!-- Botones para aceptar o cancelar cambios de nombre -->
  <div *ngIf="editandoNombre">
    <button (click)="guardarNombreLista()" class="btn save-name-btn">Aceptar</button>
    <button (click)="cancelarEditarNombre()" class="btn cancel-name-btn">Cancelar</button>
  </div>

  <!-- El resto del contenido permanece igual -->
  <div class="product-list">
    <h3 class="subtitle">Productos añadidos</h3>
    <ul class="products">
      <li *ngFor="let producto of productosLista; let i = index" class="product-item">
        <strong>{{ producto.nombre }}</strong> - 
        <span>{{ producto.unidadesPedidas }} unidades</span>

        <!-- Controles de cantidad -->
        <div class="quantity-controls">
          <button 
            class="btn quantity-btn" 
            (click)="cambiarCantidad(i, producto, -1)" 
            [disabled]="producto.unidadesPedidas <= 1">-</button>
          <span class="cantidad">{{ producto.unidadesPedidas }}</span>
          <button 
            class="btn quantity-btn" 
            (click)="cambiarCantidad(i, producto, 1)"
            [disabled]="producto.unidadesPedidas >= 10">+</button>
        </div>

        <!-- Controles de cantidad comprada -->
        <div class="quantity-controls">
          <button 
            class="btn quantity-btn" 
            (click)="cambiarCantidadComprado(i, producto, -1)" 
            [disabled]="producto.unidadesCompradas <= 0">-</button>
          <span class="cantidad">{{ producto.unidadesCompradas }}</span>
          <button 
            class="btn quantity-btn" 
            (click)="cambiarCantidadComprado(i, producto, 1)"
            [disabled]="producto.unidadesCompradas >= producto.unidadesPedidas">+</button>
        </div>

        <!-- Botón de eliminar solo si es el creador -->
        <button 
          *ngIf="esCreador" 
          class="btn delete-product-btn" 
          (click)="eliminarProducto(i, producto)">
          Eliminar
        </button>
      </li>
    </ul>
  </div>
  
  <div *ngIf="mostrarUrl; else mensajePremium">
    <p>Haz clic para invitar a alguien a esta lista:</p>
    <div class="url-container">
      <input 
        type="text" 
        [value]="generarEnlaceInvitacion()" 
        id="urlInvitacion" 
        readonly
        class="url-input" />
      <button 
        class="btn copy-url-btn" 
        (click)="copiarUrl()">Copiar URL</button>
    </div>
  </div>
  
  <ng-template #mensajePremium>
    <div class="premium-message">
      <p>Para compartir su lista debe ser <strong>Premium</strong> o eliminar algún participante.</p>
    </div>
  </ng-template>
  
  
  <!-- Botón para agregar un nuevo producto -->
  <button 
    class="btn add-product-btn" 
    name="btn_agregar_producto"
    (click)="toggleAgregarProducto()">
    + Añadir Producto
  </button>
    
    <!-- Formulario para agregar un nuevo producto -->
    <div *ngIf="mostrarAgregarProducto" class="add-product-form">
      <label for="nuevoProducto">Producto:</label>
      <input name="nombreProducto" [(ngModel)]="nuevoProducto" placeholder="Nombre del producto" />
      <br />
    
      <label for="unidadesPedidas">Unidades:</label>
      <input name="cantidadProducto" [(ngModel)]="unidadesPedidas" type="number" min="1" max="10" />
      <br />
    
      <button 
        class="btn save-product-btn" 
        name="btn_confirmar_aniadir_producto"
        (click)="aniadirProducto()"
        [disabled]="!nuevoProducto || unidadesPedidas < 1">
        Guardar Producto
      </button>
    </div>
    



  <!-- Contenedor lateral para los miembros -->
  <div class="sidebar" *ngIf="esCreador">
    <h3 class="sidebar-title">Miembros de la lista</h3>
    <ul class="member-list">
      <li *ngFor="let miembro of lista.emailsUsuarios; let i = index" class="member-item">
        <span>{{ miembro }}</span>
        <button 
          class="btn remove-member-btn" 
          (click)="eliminarMiembro(miembro)">
          Eliminar
        </button>
      </li>
    </ul>
  </div>
</div>

<!-- Botón para compartir -->
<div *ngIf="mostrarBotonCompartir; else mensajePremium">
  <p>Haz clic para compartir la lista:</p>
  <button (click)="abrirModal()">Compartir URL</button>
</div>
<ng-template #mensajePremium>
  <!-- Aquí va el mensaje que quieres mostrar cuando no se cumple la condición -->
  <p>Necesitas ser premium para compartir la URL.</p>
</ng-template>

<!-- Modal para introducir el correo -->
<div *ngIf="mostrarModal" class="modal">
  <div class="modal-content">
    <h2>Compartir URL por correo</h2>
    <input
      type="email"
      [(ngModel)]="emailDestino"
      placeholder="Introduce el correo electrónico"
      required
    />
    <button (click)="enviarEmail()">Enviar</button>
    <button (click)="cerrarModal()">Cancelar</button>
  </div>
</div>
